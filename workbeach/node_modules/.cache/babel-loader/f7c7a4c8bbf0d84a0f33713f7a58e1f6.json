{"remainingRequest":"/Applications/MAMP/gopath/vue-antd-admin/node_modules/babel-loader/lib/index.js!/Applications/MAMP/gopath/vue-antd-admin/node_modules/eslint-loader/index.js??ref--13-0!/Applications/MAMP/gopath/vue-antd-admin/src/router/guards.js","dependencies":[{"path":"/Applications/MAMP/gopath/vue-antd-admin/src/router/guards.js","mtime":1598927029039},{"path":"/Applications/MAMP/gopath/vue-antd-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/MAMP/gopath/vue-antd-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Applications/MAMP/gopath/vue-antd-admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0IHsgaGFzUGVybWlzc2lvbiwgaGFzUm9sZSB9IGZyb20gJ0AvdXRpbHMvYXV0aG9yaXR5LXV0aWxzJzsKaW1wb3J0IHsgbG9naW5JZ25vcmUgfSBmcm9tICdAL3JvdXRlci9pbmRleCc7CmltcG9ydCB7IGNoZWNrQXV0aG9yaXphdGlvbiB9IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7Ci8qKgogKiDnmbvlvZXlrojljasKICogQHBhcmFtIHRvCiAqIEBwYXJhbSBmb3JtCiAqIEBwYXJhbSBuZXh0CiAqIEBwYXJhbSBvcHRpb25zCiAqLwoKdmFyIGxvZ2luR3VhcmQgPSBmdW5jdGlvbiBsb2dpbkd1YXJkKHRvLCBmcm9tLCBuZXh0LCBvcHRpb25zKSB7CiAgdmFyIG1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2U7CgogIGlmICghbG9naW5JZ25vcmUuaW5jbHVkZXModG8pICYmICFjaGVja0F1dGhvcml6YXRpb24oKSkgewogICAgbWVzc2FnZS53YXJuaW5nKCfnmbvlvZXlt7LlpLHmlYjvvIzor7fph43mlrDnmbvlvZUnKTsKICAgIG5leHQoewogICAgICBwYXRoOiAnL2xvZ2luJwogICAgfSk7CiAgfSBlbHNlIHsKICAgIG5leHQoKTsKICB9Cn07Ci8qKgogKiDmnYPpmZDlrojljasKICogQHBhcmFtIHRvCiAqIEBwYXJhbSBmb3JtCiAqIEBwYXJhbSBuZXh0CiAqIEBwYXJhbSBvcHRpb25zCiAqLwoKCnZhciBhdXRob3JpdHlHdWFyZCA9IGZ1bmN0aW9uIGF1dGhvcml0eUd1YXJkKHRvLCBmcm9tLCBuZXh0LCBvcHRpb25zKSB7CiAgdmFyIHN0b3JlID0gb3B0aW9ucy5zdG9yZSwKICAgICAgbWVzc2FnZSA9IG9wdGlvbnMubWVzc2FnZTsKICB2YXIgcGVybWlzc2lvbnMgPSBzdG9yZS5nZXR0ZXJzWydhY2NvdW50L3Blcm1pc3Npb25zJ107CiAgdmFyIHJvbGVzID0gc3RvcmUuZ2V0dGVyc1snYWNjb3VudC9yb2xlcyddOwoKICBpZiAoIWhhc1Blcm1pc3Npb24odG8sIHBlcm1pc3Npb25zKSAmJiAhaGFzUm9sZSh0bywgcm9sZXMpKSB7CiAgICBtZXNzYWdlLndhcm5pbmcoIlx1NUJGOVx1NEUwRFx1OEQ3N1x1RkYwQ1x1NjBBOFx1NjVFMFx1Njc0M1x1OEJCRlx1OTVFRVx1OTg3NVx1OTc2MjogIi5jb25jYXQodG8uZnVsbFBhdGgsICJcdUZGMENcdThCRjdcdTgwNTRcdTdDRkJcdTdCQTFcdTc0MDZcdTU0NTgiKSk7CiAgICBuZXh0KHsKICAgICAgcGF0aDogJy80MDMnCiAgICB9KTsKICB9IGVsc2UgewogICAgbmV4dCgpOwogIH0KfTsKLyoqCiAqIOa3t+WQiOWvvOiIquaooeW8j+S4i+S4gOe6p+iPnOWNlei3s+i9rOmHjeWumuWQkQogKiBAcGFyYW0gdG8KICogQHBhcmFtIGZyb20KICogQHBhcmFtIG5leHQKICogQHBhcmFtIG9wdGlvbnMKICogQHJldHVybnMgeyp9CiAqLwoKCnZhciByZWRpcmVjdEd1YXJkID0gZnVuY3Rpb24gcmVkaXJlY3RHdWFyZCh0bywgZnJvbSwgbmV4dCwgb3B0aW9ucykgewogIHZhciBzdG9yZSA9IG9wdGlvbnMuc3RvcmU7CgogIGlmIChzdG9yZS5zdGF0ZS5zZXR0aW5nLmxheW91dCA9PT0gJ21peCcpIHsKICAgIHZhciBmaXJzdE1lbnUgPSBzdG9yZS5nZXR0ZXJzWydzZXR0aW5nL2ZpcnN0TWVudSddOwoKICAgIGlmIChmaXJzdE1lbnUuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICByZXR1cm4gaXRlbS5mdWxsUGF0aCA9PT0gdG8uZnVsbFBhdGg7CiAgICB9KSkgewogICAgICBzdG9yZS5jb21taXQoJ3NldHRpbmcvc2V0QWN0aXZhdGVkRmlyc3QnLCB0by5mdWxsUGF0aCk7CiAgICAgIHZhciBzdWJNZW51ID0gc3RvcmUuZ2V0dGVyc1snc2V0dGluZy9zdWJNZW51J107CgogICAgICBpZiAoc3ViTWVudS5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIG5leHQoewogICAgICAgICAgcGF0aDogc3ViTWVudVswXS5mdWxsUGF0aAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQoKICBuZXh0KCk7Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgYmVmb3JlRWFjaDogW2xvZ2luR3VhcmQsIGF1dGhvcml0eUd1YXJkLCByZWRpcmVjdEd1YXJkXSwKICBhZnRlckVhY2g6IFtdCn07"},{"version":3,"sources":["/Applications/MAMP/gopath/vue-antd-admin/src/router/guards.js"],"names":["hasPermission","hasRole","loginIgnore","checkAuthorization","loginGuard","to","from","next","options","message","includes","warning","path","authorityGuard","store","permissions","getters","roles","fullPath","redirectGuard","state","setting","layout","firstMenu","find","item","commit","subMenu","length","beforeEach","afterEach"],"mappings":";;;AAAA,SAAQA,aAAR,EAAuBC,OAAvB,QAAqC,yBAArC;AACA,SAAQC,WAAR,QAA0B,gBAA1B;AACA,SAAQC,kBAAR,QAAiC,iBAAjC;AAEA;;;;;;;;AAOA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MACvCC,OADuC,GAC5BD,OAD4B,CACvCC,OADuC;;AAE9C,MAAI,CAACP,WAAW,CAACQ,QAAZ,CAAqBL,EAArB,CAAD,IAA6B,CAACF,kBAAkB,EAApD,EAAwD;AACtDM,IAAAA,OAAO,CAACE,OAAR,CAAgB,aAAhB;AACAJ,IAAAA,IAAI,CAAC;AAACK,MAAAA,IAAI,EAAE;AAAP,KAAD,CAAJ;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CARD;AAUA;;;;;;;;;AAOA,IAAMM,cAAc,GAAG,SAAjBA,cAAiB,CAACR,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MAC3CM,KAD2C,GACzBN,OADyB,CAC3CM,KAD2C;AAAA,MACpCL,OADoC,GACzBD,OADyB,CACpCC,OADoC;AAElD,MAAMM,WAAW,GAAGD,KAAK,CAACE,OAAN,CAAc,qBAAd,CAApB;AACA,MAAMC,KAAK,GAAGH,KAAK,CAACE,OAAN,CAAc,eAAd,CAAd;;AACA,MAAI,CAAChB,aAAa,CAACK,EAAD,EAAKU,WAAL,CAAd,IAAmC,CAACd,OAAO,CAACI,EAAD,EAAKY,KAAL,CAA/C,EAA4D;AAC1DR,IAAAA,OAAO,CAACE,OAAR,+EAAgCN,EAAE,CAACa,QAAnC;AACAX,IAAAA,IAAI,CAAC;AAACK,MAAAA,IAAI,EAAE;AAAP,KAAD,CAAJ;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CAVD;AAYA;;;;;;;;;;AAQA,IAAMY,aAAa,GAAG,SAAhBA,aAAgB,CAACd,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MAC1CM,KAD0C,GACjCN,OADiC,CAC1CM,KAD0C;;AAEjD,MAAIA,KAAK,CAACM,KAAN,CAAYC,OAAZ,CAAoBC,MAApB,KAA+B,KAAnC,EAA0C;AACxC,QAAMC,SAAS,GAAGT,KAAK,CAACE,OAAN,CAAc,mBAAd,CAAlB;;AACA,QAAIO,SAAS,CAACC,IAAV,CAAe,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACP,QAAL,KAAkBb,EAAE,CAACa,QAAzB;AAAA,KAAnB,CAAJ,EAA2D;AACzDJ,MAAAA,KAAK,CAACY,MAAN,CAAa,2BAAb,EAA0CrB,EAAE,CAACa,QAA7C;AACA,UAAMS,OAAO,GAAGb,KAAK,CAACE,OAAN,CAAc,iBAAd,CAAhB;;AACA,UAAIW,OAAO,CAACC,MAAR,GAAiB,CAArB,EAAwB;AACtB,eAAOrB,IAAI,CAAC;AAACK,UAAAA,IAAI,EAAEe,OAAO,CAAC,CAAD,CAAP,CAAWT;AAAlB,SAAD,CAAX;AACD;AACF;AACF;;AACDX,EAAAA,IAAI;AACL,CAbD;;AAeA,eAAe;AACbsB,EAAAA,UAAU,EAAE,CAACzB,UAAD,EAAaS,cAAb,EAA6BM,aAA7B,CADC;AAEbW,EAAAA,SAAS,EAAE;AAFE,CAAf","sourcesContent":["import {hasPermission, hasRole} from '@/utils/authority-utils'\nimport {loginIgnore} from '@/router/index'\nimport {checkAuthorization} from '@/utils/request'\n\n/**\n * 登录守卫\n * @param to\n * @param form\n * @param next\n * @param options\n */\nconst loginGuard = (to, from, next, options) => {\n  const {message} = options\n  if (!loginIgnore.includes(to) && !checkAuthorization()) {\n    message.warning('登录已失效，请重新登录')\n    next({path: '/login'})\n  } else {\n    next()\n  }\n}\n\n/**\n * 权限守卫\n * @param to\n * @param form\n * @param next\n * @param options\n */\nconst authorityGuard = (to, from, next, options) => {\n  const {store, message} = options\n  const permissions = store.getters['account/permissions']\n  const roles = store.getters['account/roles']\n  if (!hasPermission(to, permissions) && !hasRole(to, roles)) {\n    message.warning(`对不起，您无权访问页面: ${to.fullPath}，请联系管理员`)\n    next({path: '/403'})\n  } else {\n    next()\n  }\n}\n\n/**\n * 混合导航模式下一级菜单跳转重定向\n * @param to\n * @param from\n * @param next\n * @param options\n * @returns {*}\n */\nconst redirectGuard = (to, from, next, options) => {\n  const {store} = options\n  if (store.state.setting.layout === 'mix') {\n    const firstMenu = store.getters['setting/firstMenu']\n    if (firstMenu.find(item => item.fullPath === to.fullPath)) {\n      store.commit('setting/setActivatedFirst', to.fullPath)\n      const subMenu = store.getters['setting/subMenu']\n      if (subMenu.length > 0) {\n        return next({path: subMenu[0].fullPath})\n      }\n    }\n  }\n  next()\n}\n\nexport default {\n  beforeEach: [loginGuard, authorityGuard, redirectGuard],\n  afterEach: []\n}\n"]}]}